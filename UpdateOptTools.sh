#!/bin/bash

echo "Starting Installer/Updater"
baseFolder="/opt/useful/"
/usr/bin/mkdir -p $baseFolder

# https://askubuntu.com/questions/15853/how-can-a-script-check-if-its-being-run-as-root#:~:text=You%20can%20accomplish%20this%20by,be%20root%20to%20do%20this.
echo "Checking root privileges..."
if [ `whoami` != 'root' ]
  then 
    echo "You must be root to do this."
  exit
fi

InstallGitRepo() {
  url_without_suffix="${1%.*}"
  base="$(basename "${url_without_suffix}")"
  repoParentFolder="$baseFolder$2"

  echo "Processing $base in $repoParentFolder ($repoParentFolder$base)"
  /usr/bin/mkdir -p $repoParentFolder
  cd $repoParentFolder
  /usr/bin/git ls-remote $1 -q
  if [ $? != 0 ]
    then
      echo "Remote endpoint $1 for $base not found"
      exit
  fi
  if [ -d "$repoParentFolder$base" ]
    then
      echo "Updating..."
      cd "$repoParentFolder$base"
      /usr/bin/git pull --ff --rebase=false 
    else
      echo "Cloning..."
      /usr/bin/git clone $1
  fi
}

InstallWithPip() {
  directory="$baseFolder$1"
  cd $directory
  /usr/bin/pip3 install .
}

# ############################################################
# ## This tool install the git repos I find most useful     ##
# ############################################################

# Security Lists
InstallGitRepo "https://github.com/danielmiessler/SecLists.git" ""

# Documentation
InstallGitRepo "https://github.com/swisskyrepo/PayloadsAllTheThings.git" "docs/"
InstallGitRepo "https://github.com/carlospolop/hacktricks.git" "docs/"

# Cracking Tools
InstallGitRepo "https://github.com/ZerBea/hcxtools.git" "tools/cracking/"
InstallGitRepo "https://github.com/hmaverickadams/breach-parse.git" "tools/"

# Enumeration Tools
InstallGitRepo "https://github.com/vdjagilev/nmap2md.git" "tools/"

# Privilage Escalation Tools
InstallGitRepo "https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite.git" "tools/"
InstallGitRepo "https://github.com/rebootuser/LinEnum.git" "tools/"
InstallGitRepo "https://github.com/SecWiki/windows-kernel-exploits.git" "tools/"

# Windows Tools
InstallGitRepo "https://github.com/fox-it/mitm6.git" "tools/"
InstallWithPip "tools/mitm6"
InstallGitRepo "https://github.com/SecureAuthCorp/impacket.git" "tools/"
InstallWithPip "tools/impacket"
InstallGitRepo "https://github.com/PowerShellMafia/PowerSploit.git" "tools/"
InstallGitRepo "https://github.com/Hackplayers/evil-winrm.git" "tools/"

# Buffer overflow
InstallGitRepo "https://github.com/corelan/mona.git" "buffer/tools/"

